# Vajalike koostude importimine
Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing
Add-Type -AssemblyName System.ServiceProcess

# Põhivormi loomine
$form = New-Object System.Windows.Forms.Form
$form.Text = "toolbox v mdgi"
$form.Size = New-Object System.Drawing.Size(400, 600)  # Muudetud vormi kõrgus
$form.StartPosition = "CenterScreen"
$form.BackColor = [System.Drawing.Color]::LightBlue

# Teeb Tab Kontrolli
$tabControl = New-Object System.Windows.Forms.TabControl
$tabControl.Dock = "Fill"
$tabControl.TabPages.Clear()

# Teep leheküljed
$killTaskPage = New-Object System.Windows.Forms.TabPage
$killTaskPage.Text = "Taskide mõrv"

$appDownloadPage = New-Object System.Windows.Forms.TabPage
$appDownloadPage.Text = "Appide tõmbamine"

$shutdownPage = New-Object System.Windows.Forms.TabPage
$shutdownPage.Text = "nupud"

$servicePage = New-Object System.Windows.Forms.TabPage  # Uus lehekülg teenuste jaoks
$servicePage.Text = "Teenuse Staatus"  

# Lisab leheküljed tab controlli
$tabControl.TabPages.Add($killTaskPage)
$tabControl.TabPages.Add($appDownloadPage)
$tabControl.TabPages.Add($shutdownPage)
$tabControl.TabPages.Add($servicePage)  # Lisa teenuste lehekülg

# teeb kontrollid service tab-i
$serviceLabel = New-Object System.Windows.Forms.Label
$serviceLabel.Text = "Valige Teenus:"
$serviceLabel.Location = New-Object System.Drawing.Point(10, 20)
$serviceLabel.Size = New-Object System.Drawing.Size(200, 20)

$serviceComboBox = New-Object System.Windows.Forms.ComboBox
$serviceComboBox.Location = New-Object System.Drawing.Point(10, 50)
$serviceComboBox.Size = New-Object System.Drawing.Size(200, 20)

# saab teenuste listi
$services = Get-Service | Select-Object -ExpandProperty Name
$serviceComboBox.Items.AddRange($services)

$statusLabel = New-Object System.Windows.Forms.Label
$statusLabel.Text = "Status:"
$statusLabel.Location = New-Object System.Drawing.Point(10, 80)
$statusLabel.Size = New-Object System.Drawing.Size(100, 20)

$statusValueLabel = New-Object System.Windows.Forms.Label
$statusValueLabel.Location = New-Object System.Drawing.Point(120, 80)
$statusValueLabel.Size = New-Object System.Drawing.Size(100, 20)

# lisab kontrollid teenuste leheküljele
$servicePage.Controls.Add($serviceLabel)
$servicePage.Controls.Add($serviceComboBox)
$servicePage.Controls.Add($statusLabel)
$servicePage.Controls.Add($statusValueLabel)

# Lisa sündmuse käsitseja teenuse valiku jaoks
$serviceComboBox.Add_SelectedIndexChanged({
    $selectedService = $serviceComboBox.SelectedItem
    $serviceStatus = (Get-Service -Name $selectedService).Status
    $statusValueLabel.Text = $serviceStatus
})

# Looge juhtimispunktid tapmisülesannete lehele...
$killTaskLabel = New-Object System.Windows.Forms.Label
$killTaskLabel.Text = "sisesta taski nimi või PID:"
$killTaskLabel.Location = New-Object System.Drawing.Point(10, 20)
$killTaskLabel.Size = New-Object System.Drawing.Size(150, 20)

$killTaskTextBox = New-Object System.Windows.Forms.TextBox
$killTaskTextBox.Location = New-Object System.Drawing.Point(10, 40)
$killTaskTextBox.Size = New-Object System.Drawing.Size(200, 20)

$killTaskButton = New-Object System.Windows.Forms.Button
$killTaskButton.Text = "Task mõrvv"
$killTaskButton.Location = New-Object System.Drawing.Point(10, 70)
$killTaskButton.Size = New-Object System.Drawing.Size(100, 30)
$killTaskButton.Add_Click({
    $taskName = $killTaskTextBox.Text
    if ($taskName) {
        try {
            Get-Process -Name $taskName -ErrorAction Stop | Stop-Process -Force
            [System.Windows.Forms.MessageBox]::Show("Task '$taskName' killed successfully.", "Success", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Information)
        } catch {
            [System.Windows.Forms.MessageBox]::Show("Failed to kill task '$taskName'. Error: $_", "Error", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Error)
        }
        $killTaskTextBox.Text = ""
    }
})

# Kontrollide lisamine tapmisülesannete lehele
$killTaskPage.Controls.Add($killTaskLabel)
$killTaskPage.Controls.Add($killTaskTextBox)
$killTaskPage.Controls.Add($killTaskButton)

# Looge rakenduse allalaadimislehe kontrolli...
$appLabel = New-Object System.Windows.Forms.Label
$appLabel.Text = "Vali Rakendused:"
$appLabel.Location = New-Object System.Drawing.Point(10, 20)
$appLabel.Size = New-Object System.Drawing.Size(200, 20)

$checkboxSpotify = New-Object System.Windows.Forms.CheckBox
$checkboxSpotify.Text = "Spotify"
$checkboxSpotify.Location = New-Object System.Drawing.Point(10, 50)
$checkboxSpotify.Size = New-Object System.Drawing.Size(150, 20)

$checkboxDiscord = New-Object System.Windows.Forms.CheckBox
$checkboxDiscord.Text = "Discord"
$checkboxDiscord.Location = New-Object System.Drawing.Point(10, 80)
$checkboxDiscord.Size = New-Object System.Drawing.Size(150, 20)

$checkboxSteam = New-Object System.Windows.Forms.CheckBox
$checkboxSteam.Text = "Steam"
$checkboxSteam.Location = New-Object System.Drawing.Point(10, 110)
$checkboxSteam.Size = New-Object System.Drawing.Size(150, 20)

$checkboxChrome = New-Object System.Windows.Forms.CheckBox
$checkboxChrome.Text = "Chrome"
$checkboxChrome.Location = New-Object System.Drawing.Point(10, 140)
$checkboxChrome.Size = New-Object System.Drawing.Size(150, 20)

$checkboxTeamspeak = New-Object System.Windows.Forms.CheckBox
$checkboxTeamspeak.Text = "TeamSpeak"
$checkboxTeamspeak.Location = New-Object System.Drawing.Point(10, 170)
$checkboxTeamspeak.Size = New-Object System.Drawing.Size(150, 20)

$downloadButton = New-Object System.Windows.Forms.Button
$downloadButton.Text = "Tõmba valitud"
$downloadButton.Location = New-Object System.Drawing.Point(10, 200)
$downloadButton.Size = New-Object System.Drawing.Size(150, 30)
$downloadButton.Add_Click({
    if ($checkboxSpotify.Checked) {
        Start-Process -FilePath "https://download.scdn.co/SpotifySetup.exe"
    }
    if ($checkboxDiscord.Checked) {
        Start-Process -FilePath "https://discord.com/api/download?platform=win"
    }
    if ($checkboxSteam.Checked) {
        Start-Process -FilePath "https://cdn.akamai.steamstatic.com/client/installer/SteamSetup.exe"
    }
    if ($checkboxChrome.Checked) {
        Start-Process -FilePath "https://dl.google.com/chrome/install/latest/chrome_installer.exe"
    }
    if ($checkboxTeamspeak.Checked) {
        Start-Process -FilePath "https://files.teamspeak-services.com/releases/client/3.5.6/TeamSpeak3-Client-win64-3.5.6.exe"
    }
    [System.Windows.Forms.MessageBox]::Show("Selected applications are being downloaded.", "Download", [System.Windows.Forms.MessageBoxButtons]::OK, [System.Windows.Forms.MessageBoxIcon]::Information)
})

# Lisage rakenduse allalaadimislehele juhtnööre
$appDownloadPage.Controls.Add($appLabel)
$appDownloadPage.Controls.Add($checkboxSpotify)
$appDownloadPage.Controls.Add($checkboxDiscord)
$appDownloadPage.Controls.Add($checkboxSteam)
$appDownloadPage.Controls.Add($checkboxChrome)
$appDownloadPage.Controls.Add($checkboxTeamspeak)
$appDownloadPage.Controls.Add($downloadButton)

# Looge juhtimisseadmed väljalülitusvalikute lehele
$shutdownLabel = New-Object System.Windows.Forms.Label
$shutdownLabel.Text = "Vali üks:"
$shutdownLabel.Location = New-Object System.Drawing.Point(10, 20)
$shutdownLabel.Size = New-Object System.Drawing.Size(200, 20)

$rebootButton = New-Object System.Windows.Forms.Button
$rebootButton.Text = "Reboot"
$rebootButton.Location = New-Object System.Drawing.Point(10, 50)
$rebootButton.Size = New-Object System.Drawing.Size(100, 30)
$rebootButton.Add_Click({
    if ([System.Windows.Forms.MessageBox]::Show("Are you sure you want to reboot the PC?", "Confirm", [System.Windows.Forms.MessageBoxButtons]::YesNo, [System.Windows.Forms.MessageBoxIcon]::Warning) -eq [System.Windows.Forms.DialogResult]::Yes) {
        Restart-Computer -Force
    }
})

$logOutButton = New-Object System.Windows.Forms.Button
$logOutButton.Text = "Log Out"
$logOutButton.Location = New-Object System.Drawing.Point(10, 90)
$logOutButton.Size = New-Object System.Drawing.Size(100, 30)
$logOutButton.Add_Click({
    if ([System.Windows.Forms.MessageBox]::Show("Are you sure you want to log out?", "Confirm", [System.Windows.Forms.MessageBoxButtons]::YesNo, [System.Windows.Forms.MessageBoxIcon]::Warning) -eq [System.Windows.Forms.DialogResult]::Yes) {
        shutdown.exe /l /f
    }
})

$emptyRecycleBinButton = New-Object System.Windows.Forms.Button
$emptyRecycleBinButton.Text = "Tühjenda Prügi"
$emptyRecycleBinButton.Location = New-Object System.Drawing.Point(10, 130)
$emptyRecycleBinButton.Size = New-Object System.Drawing.Size(150, 30)
$emptyRecycleBinButton.Add_Click({
    Clear-RecycleBin -Force
})

$sleepButton = New-Object System.Windows.Forms.Button
$sleepButton.Text = "Sleep"
$sleepButton.Location = New-Object System.Drawing.Point(10, 170)
$sleepButton.Size = New-Object System.Drawing.Size(100, 30)
$sleepButton.Add_Click({
    Add-Type -AssemblyName System.Windows.Forms
    [System.Windows.Forms.Application]::SetSuspendState([System.Windows.Forms.PowerState]::Suspend, $false, $true)
})

# Lisage juhtnupud väljalülitamisvalikute lehele
$shutdownPage.Controls.Add($shutdownLabel)
$shutdownPage.Controls.Add($rebootButton)
$shutdownPage.Controls.Add($logOutButton)
$shutdownPage.Controls.Add($emptyRecycleBinButton)
$shutdownPage.Controls.Add($sleepButton)


# Lisab vormile vahekaart
$form.Controls.Add($tabControl)

# Näita vormi
$form.Add_Shown({ $form.Activate() })
$form.ShowDialog() | Out-Null
